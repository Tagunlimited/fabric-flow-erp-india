â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           SCISSORS ERP - INITIAL MIGRATION FILE CREATED                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ File: supabase/migrations/scissors_initial_migration.sql
ğŸ“ Size: 2,269 lines of SQL
ğŸ“… Generated: November 11, 2025
âœ… Status: Ready for deployment

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“¦ WHAT'S INCLUDED:

PART 1: ENUMS & CUSTOM TYPES
   â”œâ”€ user_role (9 values)
   â”œâ”€ customer_type (6 values)
   â”œâ”€ customer_tier (4 values)
   â”œâ”€ order_status (15 states)
   â”œâ”€ production_stage (5 stages)
   â”œâ”€ quality_status (4 states)
   â””â”€ dispatch_status (4 states)

PART 2-16: DATABASE TABLES (40+ tables organized by module)
   
   CRM MODULE (5 tables)
   â”œâ”€ profiles
   â”œâ”€ customers
   â”œâ”€ customer_users
   â”œâ”€ customer_portal_settings
   â””â”€ customer_activity_log
   
   ORGANIZATION (4 tables)
   â”œâ”€ departments
   â”œâ”€ employees
   â”œâ”€ roles
   â””â”€ user_roles
   
   PRODUCTS & MASTERS (9 tables)
   â”œâ”€ product_categories
   â”œâ”€ size_types
   â”œâ”€ fabrics
   â”œâ”€ fabric_variants
   â”œâ”€ fabric_master (legacy)
   â”œâ”€ product_master
   â”œâ”€ item_master
   â”œâ”€ inventory
   â””â”€ products
   
   ORDERS & SALES (3 tables)
   â”œâ”€ orders
   â”œâ”€ order_items
   â””â”€ order_assignments
   
   PROCUREMENT (7 tables)
   â”œâ”€ supplier_master
   â”œâ”€ supplier_specializations
   â”œâ”€ purchase_orders
   â”œâ”€ purchase_order_items
   â”œâ”€ purchase_order_attachments
   â”œâ”€ purchase_order_deliveries
   â”œâ”€ grn_master
   â””â”€ grn_items
   
   BOM (2 tables)
   â”œâ”€ bom_records
   â””â”€ bom_record_items
   
   PRODUCTION (7 tables)
   â”œâ”€ production_orders
   â”œâ”€ production_team
   â”œâ”€ quality_checks
   â”œâ”€ batches
   â”œâ”€ tailors
   â”œâ”€ order_batch_assignments
   â””â”€ order_batch_size_distributions
   
   ACCOUNTS (6 tables)
   â”œâ”€ quotations
   â”œâ”€ quotation_items
   â”œâ”€ invoices
   â”œâ”€ invoice_items
   â””â”€ receipts
   
   DISPATCH (1 table)
   â””â”€ dispatch_orders
   
   WAREHOUSE (10 tables)
   â”œâ”€ warehouses
   â”œâ”€ floors
   â”œâ”€ racks
   â”œâ”€ bins
   â”œâ”€ warehouse_inventory
   â”œâ”€ inventory_allocations
   â”œâ”€ inventory_adjustment_reasons
   â”œâ”€ inventory_adjustments
   â”œâ”€ inventory_adjustment_items
   â”œâ”€ inventory_adjustment_bins
   â””â”€ inventory_adjustment_logs
   
   ADDITIONAL (2 tables)
   â”œâ”€ branding_types
   â””â”€ calendar_events

PART 17: PERFORMANCE INDEXES
   â””â”€ 40+ indexes on frequently queried columns

PART 18-19: ROW LEVEL SECURITY
   â”œâ”€ RLS enabled on all 40+ tables
   â”œâ”€ Standard authenticated user policies
   â””â”€ Special customer portal policies

PART 20: HELPER FUNCTIONS (15+)
   â”œâ”€ generate_order_number()
   â”œâ”€ generate_po_number()
   â”œâ”€ generate_grn_number()
   â”œâ”€ generate_invoice_number()
   â”œâ”€ generate_receipt_number()
   â”œâ”€ generate_quotation_number()
   â”œâ”€ generate_production_number()
   â”œâ”€ generate_dispatch_number()
   â”œâ”€ generate_employee_code()
   â”œâ”€ recalculate_po_totals()
   â”œâ”€ refresh_customer_pending()
   â”œâ”€ is_admin()
   â”œâ”€ create_customer_portal_user_safe()
   â”œâ”€ create_employee_user_account()
   â”œâ”€ handle_new_user()
   â””â”€ update_updated_at_column()

PART 21: TRIGGERS (20+)
   â”œâ”€ Auto-number generation triggers
   â”œâ”€ Updated_at timestamp triggers
   â””â”€ Auth user creation trigger

PART 22: STORAGE BUCKETS (6)
   â”œâ”€ avatars (public, 5MB)
   â”œâ”€ category-images (public, 10MB)
   â”œâ”€ order-images (public, 10MB)
   â”œâ”€ order-attachments (private, 50MB)
   â”œâ”€ company-assets (public, 10MB)
   â””â”€ product-images (public, 10MB)

PART 23: DEFAULT DATA
   â”œâ”€ 6 default roles
   â”œâ”€ 8 default inventory adjustment reasons
   â””â”€ Initial company settings

PART 24: VIEWS (3)
   â”œâ”€ warehouse_inventory_allocation_summary
   â”œâ”€ order_batch_assignments_with_details
   â””â”€ qc_reviews

PART 25: GRANTS & PERMISSIONS
   â””â”€ Proper access control for all objects

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ DEPLOYMENT READY!

The migration file is production-ready and can be deployed to any Supabase
database. It's designed to be idempotent (can be run multiple times safely).

See MIGRATION_README.md for detailed deployment instructions.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
